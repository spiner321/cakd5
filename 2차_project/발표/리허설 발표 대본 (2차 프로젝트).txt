1. 안녕하세요 cakd 5 데이터 어셈블팀 2차 기업 연계 프로젝트 'APS 시스템 구축을 통한 수요 예측 및 원자재 발주 자동화' 발표를 시작하겠습니다. 

2. 목차는 다음과 같습니다. 비즈니스 이슈, 프로젝트 과제 정의, 프로젝트 과정 및 기대효과, APS 시스템 시연 순서로 발표를 진행하겠습니다. 

3. 우선 첫 번째 장에서는 기업의 제품과 제조 공정에 대해서 소개하고 현재 기업이 직면하고 있는 비즈니스 이슈에 대해서 설명드리겠습니다. 

4. 저희가 데이터를 제공받은 기업은 콘크리트용 화학 혼화제, 터널 공사용 급결제 등을 제조 및 판매하는 건설 화학 소재 분야 제조업체입니다. 
   전반적인 공정 흐름은 건설 회사로부터 주문을 받고 생산 계획을 수립하고 원자재 발주를 합니다. 원자재가 입고되면 제품 생산을 시작하고 의뢰받은 건설회사에게 제품을 납품합니다. 
   다섯 단계의 공정 중 생산계획 수립 및 원재료 발주 과정에서 어려움을 겪고 있었습니다. 

5. 이 단계에서 발생한 비즈니스 이슈는 총 세 가지로 중장기적 수요 예측의 부재로 장기적인 플랜에 대한 준비가 미흡하였고,  단기 수요 예측은 실제 수주 수요량과의 차이가 있어 생산 및 판매에 차질을 빚고 있었습니다. 
또한 매일 1시간 30분 가량을 단순 반복 업무에 낭비하고 있었습니다. 

6. 두 번째 장에서는 기업의 비즈니스 이슈를 해결하기 위한 프로젝트 과제를 정의하였습니다. 

7. 앞서 언급된 세 가지 이슈를 해결하기 위해서는 중장기적 수요 예측이 이루어져야 했고 정확도를 높인 생산 판매계획을 바탕으로 원자재 재고 관리가 이루어져야 했습니다. 

   저희는 이 같은 문제를 APS 시스템을 통해 해결할 수 있다고 파악하였습니다. 저희가 구축할 APS 시스템은 AI기반의 예측 방법을 통하여 생산계획 및 자원 소요 계획을 스케줄링합니다. 

8. 기존

기존 erp 시스템과 MES 시스템만의 교환으로 이뤄졌던 기존의 과정에 비해 APS 시스템을 추가하여 작동되는 단계는 다음과 같습니다. 
기업의 erp와 외부 데이터를 데이터 마트에 저장해 통합 관리를 하고 이를 활용해 APS 시스템에서 수요량을 예측하고 생산 계획을 세웁니다. 그리고 생산 계획을 통해 원자재 발주량을 mes 시스템과 연동하여 관리합니다. 
MES 시스템의 원자재 재고 정보는 ERP와 데이터 마트에 다시 업데이트 되고 이를 바탕으로 aps 시스템이 다시 미래 수요량을 예측합니다. 

기존의 과정에 비해 AI 기반 APS 시스템을 사용하면 정확도 높은 생산 계획과 자원소모 계획을 세울 수 있습니다.

9. APS 시스템을 구축하기 위한 과제 해결 단계는 다음과 같습니다. 우선 데이터 마트를 구축하고 머신러닝과 딥러닝을 사용해 수요량을 예측합니다. 예측값을 바탕으로 생산 계획을 세워 원자재 발주를 자동화합니다. 그리고 장기 수요 예측 대시보드와 생산 관리 대시보드를 제작하고 데이터를 시각화하여 시스템 관리를 보다 용이하게 합니다. 

10. 다음 3장에서는 앞서 네 단계로 구분한 과제 해결 과정을 상세히 설명하겠습니다.

과제 해결 과정 

11 APS 시스템에서 사용하기 위해 erp 시스템에 정리되어 있지 않던 내부데이터와 외부 데이터를 모아 마리아 DB를 사용해 가상환경에서 데이터 마트를 구축하였습니다.
    
데이터 마트에 포함된 데이터는 일별 날씨 정보, 건축착공면적, 변수예측, 수요예측, 안전재고량, 일별 소모 원자재, 원자재 발주, 일별 원자재 재고입니다. 
	
12 
	다음으로 수요예측에 대해 설명하겠습니다.
	보시는 바와 같이 총 3단계로 구성되어 있습니다.
	도메인 지식을 활용한 변수들의 선정 근거를 살피고,
	변수 데이터들을 시계열모델을 활용하여 증강시킨 뒤,
	머신러닝, 딥러닝 모델로 수요를 예측합니다.
	
	이제 과정들을 설명드리겠습니다.
	
	먼저 변수선정입니다.
	건축착공면적은 건설경기 동행지표로서, 자재수급 동향 등을 예측해볼 수 있는 통계자료입니다.
	위쪽의 그래프는 주어진 실데이터에서 요일을 보정한 뒤
	월별 합계를 내어 착공 면적과 비교한 그래프입니다. 
	추세를 비슷하게 따라가고 있는 모습을 볼 수 있고, 
	아래쪽 히트맵을 보아도 밀접한 관계가 있음을 알 수 있습니다.
	따라서 데이터 증강 시에도 이것이 계절성으로서 반영될 수 있도록 하였습니다.
	
	또한 건설업계에서는 온도, 습도, 강수량, 강설량과 같은 날씨 상황이 많은 영향을 끼칩니다.
	특히 강수량과 강설량은 콘크리트 강도 저하 우려 등으로 인해 영향이 있습니다.
	이것을 데이터 증강 시에 반영하였습니다.
	
	다음은 변수 데이터 증강입니다. 
	저희가 예측할 3개월에서 6개월의 기간에는 이 변수들이 없습니다.
	하지만 이 변수들은 정상성을 가지고 있으므로, 시계열 모델로써 어느 정도 예측할 수 있습니다.
	그래프에서 파란색으로 된 그래프는 트레인데이터, 
	초록색으로 된 그래프는 테스트 데이터,
	빨간색으로 된 그래프는 예측 그래프입니다.
	어느정도 잘 예측하는 것을 볼 수 있고, 
	평가지표인 r2 score 역시 0.6~ 0.99로 준수한 것을 볼 수 있습니다.
	착공면적 역시 adf 테스트 결과 정상성이며(자료엔 없음)
	r2 score 0.71로 준수하게 예측된 것을 볼 수 있습니다.
	
	변수들의 예측된 값을 기존 데이터와 함께 나타낸 그래프입니다.
	위화감 없이 예측된 것을 볼 수 있습니다.
	
	이제 이렇게 증식된 변수들을 이용해 머신러닝 모델에 대입합니다.
	각 모델들은 최적화 되어 있는 상태이며, 
	r2 socre는 LGBM Regressor 모델이 0.87로 가장 높고, 오차들 역시 대부분 낮습니다.
	따라서, LGBM Regressor 모델을 사용하여 수요 예측을 진행하였습니다.
	예측된 결과는 뒤에서 시각화 도구와 함께 보여드리도록 하겠습니다.

	3) 생산계획 & 원자재 발주 - 여기서 안전재고량 설명 (성윤)
	피드백 : 리드타임 추가 
생산 계획

생산 계획이란 생산 개시에 앞서서 제품의 종류, 수량, 가격, 생산 방식, 장소, 기간 등에 대한 계획을 세우는 것올 말합니다. 저희는 중장기 수요 예측 데이터의 앞 3개월을 활용하여 생산 계획을 수립하였습니다. 

생산 계획에는 예측한 미래의 수주 정보가 담겨 있습니다. 이 예측 판매량과 데이터마트에 저장된 원자재 정보를 활용하여 MES를 구축하고 구축된 MES는 데이터마트와 계속 연동하여 원자재 발주 및 재고관리를 자동화 합니다.

S사는 원자재 발주부터 입고까지 6일, 제품 수주로부터 납기까지 3일, 총 9일의 평균 리드타임을 가지고 있습니다. 따라서 원자재 발주는 매주 월요일마다 이뤄지며 원자재 발주가 들어가는 다음 주 월요일부터 일요일까지의 제품 생산에 필요한 총 원자재량을 계산하여 이에 맞춰 발주가 들어가게 됩니다. 

원자재를 발주할 때는, 리드타임 동안 발생할 수 있는 비상 수요에 대비하기 위해 보유하는 최소재고량인 안전재고량을 기준으로 발주를 시행합니다. (안전재고량 기준으로 발주하는 방법 그래프 그리기)

안전 재고량 = (일일 최고 판매량 X 최대 리드타임) - (일일 평균 판매량 X 평균 리드타임)

	원자재 자동발주 부분을 설명 하겠습니다.

	(리드타임) 
	S사에서는 일주일에 한번씩 발주를 하고 6일 이후에 원자재가 입고됩니다.

	원자재 자동 발주는 MES의 원자재 재고 데이터와 단기생산계획모델로 예측된 원자재를 통해 자동으로 다음주에 필요한 
	발주량이 정해집니다. 

	다음은 안전재고량에 대해 설명 하겠습니다.

	안전재고량이란 예측과정에서 발생된 오차와 발주가 되기전 일주일 동안 필요한 비상 수요에 대비하기 위한 재고 입니다.

	안전 재고량 = (일일 최고 판매량 X 최대 리드타임) - (일일 평균 판매량 X 평균 리드타임) 
	리드타임 : 9일 (원자재 발주부터 입고까지 6일, 제품 수주로부터 납기까지 3일) 
	
	원자재는 항상 안전재고량 이상을 유지 해야 하므로 사용하고 난 원자재가 안전재고량보다 밑으로 내려간 경우
	안전재고량 까지 필요한 원자재량과 3개월 생산계획 예측모델에서 나온 필요 원자재량을 합쳐서 자동발주 시스템을 완성 하였습니다. 

대시보드 구축 

6개월 장기 수요 예측 결과를 보여주는 장기 수요 예측 대시보드와 3개월 생산 계획에 따른 자재 발주를 확인할 수 있는 생산관리 대시보드로 총 두 개를 제작하였습니다. 

우선 장기 수요 예측 대시보드에 대해서 설명드리겠습니다. 

첫 번째 라인그래프에서는 그간 제품이 판매된 흐름과 예측 기준일 이후 6개월 동안의 수요량을 파악할 수 있습니다. 

두 번째 바 그래프에서는 제품별 6개워 수요 예측을 확인할 수 있고 6개월간 제품 소요량의 총 합계도 살펴볼 수 있습니다. 제품을 선택하면 상단의 라인 그래프도 제품별로 변화하는 것을 확인할 수 있습니다. 

마지막에 위치한 그래프에서는 고객사별 수요 예측을 확인할 수 있습니다. 그래프에 마우스를 위치시키면 제품별 예측 주문량도 확인할 수 있습니다.

중장기 수요 예측 모델에 따라 

월별로 총 생산되는 제품의 양을 확인할 수 있고 캘린더 차트를 통해 일별로 어떤 제품이 얼마만큼 생산되는지 확인할 수 있습니다. 

아래의 차트에서는 월별, 주별, 일별로 제품 생산에 필요한 원자재 별 총량을 확인할 수 있습니다. 

그리고 오늘 날짜에 맞춰 원자재 재고 현황과 안전재고 대비 원자재 재고를 확인할 수 있습니다. 

좌측 원자재 발주 칸에서는 오늘 날짜와 다음 발주일자를 확인할 수 있고 다음 발주 시기 어떤 원자재를 얼만큼 생산해야하는지 알 수 있습니다. 

발주일이 되었을 때 데이터 복사 기능을 통해 생산 담당자에게 발주 이메일을 간편하게 전송할 수 있습니다. 

사용 설명서 제작 

	위에서 했던 내용들을 바탕으로 사용설명서를 제작하였습니다.
 
 	사용설명서는 코드에 대해서 잘 모르는 분들도 보다 더 쉽게 접근할
 	 수 있도록 구성하였습니다.
 
  	사용설명서에는 소프트웨어에 대한 요약도를 제공하였으며, 

  	DB를 구축하는 과정과 DB에 필요한 파일에 대하여 설명하였습니다.

5. 활용 기술 및 팀원 소개
	프로젝트에서 사용한 언어, 사용 환경 및 활용 라이브러리 입니다. 

Google Cloud Platform 에서 마리아db를 사용하여 데이터 마트를 생성하였으며, 파이썬과 sql을 사용하여 데이터를 사용하여
데이터를 입력하였습니다. 
API 시스템 구현을 위해 콜랩과 주피터 노트북을 사용하였으며, PYMYSQL, SQLALCHEMY, BEAUTIFULSOAP 등 다양한 파이썬
라이브러리를 사용하였습니다.
이후 시각화 과정에서는 데이터베이스와 연동된 TABLEAU를 사용하여 대시보드를 구현하였습니다.

	