기획서
데이터를 제공받은 고객사 설명 
고객사 : 콘크리트용 화학 혼화제, 터널 공사용 급결제 등 건설 소재 제조업체 

고객사 설명 : 건설회사에서 고객사에게 주문을 하면 고객사에서 완제품을 만들고 건설현장에 납품


1. 비즈니스 이슈 

1) 직전 3개월 판매량을 기준으로 3개월 생산계획(수작업)을 실행하지만 계획과 실제 판매량에서의 차이가 발생함 
-> 생산 납기 지연, 재고량 증가로 인한 창고 비용 등 불필요한 비용이 발생
기존 방식 : 3개월 전의 영업수주건을 바탕으로 다음 분기의 생산량을 예측


2) 중장기적인 수요 예측을 하지 않아서 장기적인 플랜에 대한 준비가 미흡함 
-> 시계열, 회귀모델 

3) 재고파악, 발주량 산출, 원재료 발주 등 단순 반복 업무에 인력 및 시간 투입 
(수작업) 1일 2회 90분


2. 프로젝트 정의(과제 도출) 

스마트 팩토리란? 
https://www.smart-factory.kr/smartFactoryIntro#:~:text=%EC%A0%95%EC%9D%98,%EC%9D%98%20%EC%B2%A8%EB%8B%A8%20%EC%A7%80%EB%8A%A5%ED%98%95%20%EA%B3%B5%EC%9E%A5%EC%9D%B4%EB%8B%A4

생산 설비-자재-시스템 간 실시간 정보교환 시스템과 생산현황에 맞춘 실시간 자동 수발주 

TO_BE 요청 사항 

1. 기존 수요량 예측 방법을 개선하여 예측율을 높임

2. 3개월치 소요량을 예측하여 월, 일별로 스케줄링하고 그 결과를 통해 원자재 구매를 입찰 처리

3. 입찰된 거래 업체 발주시기를 예측하여 자동 발주 할 수 있도록 함 


이슈를 해결하기 위해 
1) 생산 판매 계획

2) 중장기 수요 예측

3) 재고파악 및 주문 자동화

3. APS 시스템이란? AI 기반 Advanced Planning and Scheduling,



APS 시스템 KPI (핵심성과지표)

- 수요 예측 정확도 : 미래 4~6월 수요 예측 VS 동기간 판매 실적

- 판매 능력 지수 : 3개월 판매 실행 계획 VS 동기간 판매 실적


0) 데이터마트, 마리아 DB
ERP, MES Manufacturing execution system (통합 생산 관리 시스템)
외부데이터 : 계절성 특성 반영-> (온도, 습도/ ex. 공사현장개수) , 경기흐름(한국은행의 건축착공면적 사용)

* 공사현장에서의 온도, 습도 도메인을 알면 범주화 가능할 듯 

1) 2.5개월 데이터 증식

계절성, 추세 반영 
- 기상청 데이터(지역, 지역에 해당하는 온도와 습도), 건축 착공면적, 건축 허가면적
XG부스트로 일별 제품별 판매량 예측 

2) 수요 예측 시뮬레이션 : 중장기 수요예측, 6개월 OR 1년 -> 설비투자 의사결정 지원 

모델 : 시계열모델 (SARIMA-계절추세반영, GRU, Bi-LSTM 양방향 LSTM 
*GAN으로 결측치 채우기
*TadGan으로 시계열 데이터 이상탐지  
RNN
LSTM - Vanishing gradient 문제 해결
* BiLSTM -LSTM과 BRNN을 결합한 양방향 LSTM (Bi-LSTM)을 적용한다. 앞에서 설명한 것처럼 LSTM과 BRNN은 개선된 RNN으로 LSTM은 기울기 소실 문제를 극복하며, BRNN은 순방향과, 역방향의 은닉층 연산을 반영하여 예측성능을 향상시킨다.  
GRU - LSTM과 비슷하지만 LSTM 보다 빠름
정확도 R Squared -> 제품 pema-pr1500기준, 제품 하나 선택해서 측정
-> 기존 시스템 대비 정확도 약 얼마나 개선 됐는지 확인 가능 

날씨데이터_기온, 날씨데이터_습도에 그루모델을 썼던데 이게 뭘까 
GRU, 다변량 시계열 예측 

	시계열 분석용 데이터셋 생성
	모형 최적화 매개변수 도출
	수요 예측 시뮬레이션 모델
	카테고리별 수요 시뮬레이션 (총량, 거래처, 제품별 6개월 수요 시뮬레이션)
	자원 소요 계획 시뮬레이션 
	수요 예측 시각화

3) AI 기반 생산 계획 모형 : 
3개월 (일,주,월)별 판매량 예측

목적 : 수요예측 모델에서 나온 3개월의 예측 판매량과 외부요인들을 가지고 실제 판매량을 예측한다. 

방법 : 6개월의 시계열 분석을 통해 나온 예측 판매량으로 실제 판매량을 예측하는데 중요하다고 생각되는 외부요인들을 파생변수로 추가하여 
머신러닝을 활용한 회귀모델을 통해 3개월치의 예측 판매량의 정확도를 높여 도출한다.  

모델 : 회귀모델 , 회귀트리 (RF, LGBM, DT, XGB) / 선형회귀도 쓸건가 쓰면 원핫인코딩 적용 

<종속> 판매량 예측 (1년 or 6개월) 
<독립> * https://clomag.co.kr/article/2011 양파참고 
1) 건축허가면적
2) 건축착공면적
3) 온도
4) 상대습도 : 
* 콘크리트는 온도에 따른 품질변동이 큰 재료로서, 타설 후 소요의 품질을 확보하기 위해 계절특성파악 및 콘크리트 주위의 온 습도를 적절한 범위로 유지시켜 유해한 작용을 받지 않도록 주의해야 한다.
5) 지역 
6) 제품코드
7) 거래처코드

http://www.index.go.kr/potal/main/EachDtlPageDetail.do?idx_cd=1224
건축허가면적 : 건설경제동향, 주택수급동향 등의 진단 및 건축자재 수급ㆍ생산 예측을 위한 기초 통계자료임 
건축착공면적 : 건설경제동향, 자재수급 동향 등을 예측해볼 수 있는 통계자료임

	파생 변수 전처리
	분석용 데이터셋	
	분석 알고리즘
	모형 성능 평가 RMSLE, MSE, RMSE
	모형 하이퍼파라미터 튜닝
	AI 기반 수요 확정 모형
	수요 확정 모형을 활용한 3개월 판매 실행 계획 도출


4) 원자재 자동 발주 PSI Format(생산계획 대비 출하계획) -> PSI(Production, Sales, Inventory) 체계
리드타임 : 9일 (원자재 발주부터 입고까지 6일, 제품 수주로부터 납기까지 3일) 
* 리드타임? 일반적으로 원자재가 입고되는 시점 또는 생산에 원자재가 투입되는 시점부터 제품이 완성되어 완제품 창고에 입고되거나, 
완성된 제품이 출고되는 시점까지의 기간을 의미

MES의 원자재 재고 + 생산판매계획모델을 통해 예측된 판매량 = 구입이 필요한 원자재 발주량 산출 

생산판매계획에서 발생할 수 있는 오차와 비상수요에 대해서는 안전재고량을 설정해 보안  
* 안전 재고량 :  리드타임동안 발생할 수 있는 비상 수요에 대비하기 위해 보유하는 재고 
안전 재고량 = (일일 최고 판매량 X 최대 리드타임) - (일일 평균 판매량 X 평균 리드타임) -> 납기일(3일) 자체가 짧을 경우 사용하는 방식

5) APS 시각화 대시보드 (시각화, 태블로) : 
* 대시보드 : 필요한 핵심 그래프 조합해 시각화 그래프 한 눈에 확인 가능
최종 산출 : 영업 수주기본의 수주예측 계획정보, 자재발주기본의 발주예정계획 정보
중장기 수요 예측 모델과 생산 판매계획 모델을 통한 예측량을 시각화 
예측량은 제품별, 원자재별, 기간별 다양하게 표현 
대시보드 4개: 생산판매계획, 중장기수요, 원자재 재고, 원자재발주 (금일 원자재 발주내역) 

6) 카카오톡 챗봇 알림 
https://www.youtube.com/watch?v=TPj4fNDjo3c, https://brunch.co.kr/@dope/24 (참고용)
-> 4.15 카카오 채널 개설 및 OBT(OPEN BETA TEST) 참여 신청 (3-5일 소요) 
채널 URL : http://pf.kakao.com/_xkiTDb
채팅 URL : http://pf.kakao.com/_xkiTDb/chat

REST_API = 09b00151b2d29f527c79d113741c960e
code = yYCKQ5LjYN6wNHRh7RYmoX9E2nSYSTcTBbhpy2EnY-SrNSYNkxwetJRGS5Ni-YllpTbWsQopcJ8AAAGALE4chw

- 정확한 생산현장 데이터 수집, 전달을 통한 관리 효율화
정보시스템을 통해 작업지시의 정확한 전달, 작업지시에 대한 실시간 진척도 파악,
작업결과의 전달, 담당자 호출 등 신속 정확한 의사전달로 문제해결 소요시간 단축

-카카오톡을 활용한 실시간 공정관리 시스템 -> 자동발주
1. 생산량·공정시스템·기기오류 등 제조∙설비에서 발생하는 다양한 정보를 클라우드에 저장하고, 해당 내용을 담당자에게 카카오톡으로 전달
2. 관리자가 공장 내 대기하거나 PC를 통해 확인하지 않아도 카카오톡으로 전달되는 내용에 따라 실시간 대응이 가능
서비스
<T-fac> https://m-intro.t-fac.co.kr/introduce
▲업무(당일 목표 생산량 및 업무 지시 공유 및 실시간 진행 사항) 
▲알람(공정 내 시스템 이슈를 실시간 대응)기능
▲인포(공정 장비 상황) 
▲문서(사내 보고 자료 자동화) 
▲클러스터(공정 간 발주 현황) 서비스

웰컴블록 : 안녕하세요. 데이터어셈블 스마트팩토리입니다.
시나리오 추가

스킬 : 구름IDE, 추가 모듈 DB가능?

챗봇 VS 알림톡
카카오 Open API 활용 - 나에게 카톡 메세지 보내기 https://ai-creator.tistory.com/23
 
7) 수요발주예측관리_메뉴얼 제작
고객사 배부용 메뉴얼 제작 (DB 구축, 데모 파일 설명 및 실행순서, 태블로 설치 및 이용방법) 

4. 기대효과
1) 생산판매계획 정확도 개선
2) 중장기 수요예측을 이용한 설비투자 의사결정 지원
4) 원자재 재고파악 및 주문 자동화로 인해 업무시간 연 400시간 절감 


2020년 2019년 

2021년 : 완제품별 주문 구조 만들기 (거래처, 기간별) 2.5개월 단위로 -> 계절별 지수 부여해서 수요 변화 파악 -> 연간 구조 만들 수 있음 -> 랜덤으로 수 부여

2021년 가지고 2020, 2019만들기