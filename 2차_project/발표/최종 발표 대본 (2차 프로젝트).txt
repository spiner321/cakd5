1. 
안녕하세요 데이터 어셈블팀 기업 연계 프로젝트/ 
'AI 기반 스마트 팩토리' 발표를 시작하겠습니다. 


2. 
목차는 다음과 같습니다. 비즈니스 이슈 소개를 소개하고 프로젝트 과제를 정의합니다. 그리고 구체적인 프로젝트 진행 과정과 이슈 해결에 따른 기대효과를 발표합니다. 마지막으로 대시보드를 통한 APS 시스템 시연을 진행하도록 하겠습니다. 


3. 
우선 첫 번째 장에서는 연계 기업의 제품과 제조 공정에 대해서 간략히 소개하고 현재 이 기업이 직면하고 있는 비즈니스 이슈에 대해서 설명드리겠습니다. 


4. 
저희가 데이터를 제공받은 기업인 S사는 콘크리트용 화학 혼화제, 터널 공사용 급결제 등을 제조 및 판매하는 건설 화학 소재 분야 제조업체입니다. 
S사의 전반적인 공정 흐름은 다음과 같습니다. 
우선 건설 회사로부터 주문을 받아 생산 계획을 수립하고 제품 생산에 필요한 원자재를 발주 합니다. 
그리고 원자재가 입고되면 제품 생산을 시작하고 제품이 완성되면 의뢰받은 건설회사에게 완제품을 납품합니다.

S사는 이 다섯 단계의 공정 중 생산 계획 수립 및 원자재 발주 과정에서 보다 효율적인 생산 관리 프로세스의 필요성을 느끼고 있었습니다. 


5. 
이 단계에서 발생한 비즈니스 이슈는 총 세 가지로 구분할 수 있습니다.  
첫 번째는 6개월 이상의 중장기적 수요 예측이 이루어지지 않아 장기적인 플랜에 대한 준비가 미흡하다는 점입니다.  
그리고 기존의 단기 수요 예측 방법은 정확도가 낮아 제품 생산 및 판매 단계에서 차질을 빚고 있다는 점입니다. 
마지막으로 자동화가 이루어질 수 있는 단순하고 반복적인 업무에 매일 1시간 30분 가량의 시간과 인력을 소모하고 있다는 점입니다.


6. 
두 번째 장에서는 앞서 말씀드린 비즈니스 이슈를 해결하기 위한 프로젝트 과제를 정의한 부분에 대해서 말씀드리겠습니다.


7. 
세가지 이슈 사항을 해결하기 위하여 APS시스템을 구축할 것을 프로젝트 과제로 설정하였습니다.
APS 시스템은 AI기반의 수요 예측을 통하여 정확도를 높인 생산계획 및 자원 소요 계획을 스케줄링할 수 있습니다. 


8. 
APS 시스템의 도입 전 후로 / 회사의 데이터가 활용되는 방식에서의 차이점을 소개해드리겠습니다. 

기존의 사내 데이터 활용은 단순히 ERP와 MES의 교환으로 이뤄진데 반해, 
APS 시스템 도입 후는 데이터 마트가 추가됨으로써 더 많은 단계에서 유기적으로 데이터가 교환됩니다.
 
데이터 마트에는 기업의 ERP 데이터와 APS 수요 예측에 활용될 외부 데이터가 저장되고 

APS 에서는 이 데이터들을 불러와 수요 예측과 생산 계획에 대한 정보를 만들어 냅니다. 

그리고 이 정보는 MES와 연동되어 원자재 발주 및 재고를 자동으로 관리 합니다.
 
MES의 원자재 재고 정보는 데이터 마트에 다시 업데이트 되고 이를 바탕으로 APS가 다시 미래 수요를 예측할 수 있습니다.

기존의 과정에 비해 AI기반 APS 시스템을 사용하면 더 많은 데이터의 유기적 활용을 통해 정확도 높은 생산 계획을 세울 수 있고 
재고 관리 및 자재 발주 단계가 자동화 되어 생산성을 크게 향상 시킬 수 있습니다.


9. 
APS 시스템을 구축하기 위한 과제 해결 단계는 다음과 같습니다. 데이터 마트를 구축하고 머신러닝과 딥러닝을 사용해 수요량을 예측합니다.  이 예측값을 바탕으로 생산 계획을 세워 원자재 발주를 자동화합니다. 그리고 장기 수요 예측 대시보드와 생산 관리 대시보드를 제작함으로써 데이터를 시각화하여 시스템 관리를 보다 용이하게 합니다. 


10. 
세 번째장에서는 앞서 네 단계로 구분한 과제 해결 과정을 상세히 설명하고 이에 따른 기대 효과에 대해 말씀드리겠습니다.


11.
APS 시스템 구현을 위해서는 유기적으로 통합된 데이터가 필요하므로,
다양한 형식의 데이터를 모은 후 통일성이 없거나, 오류가 있는 데이터를 전처리합니다.
전처리에는 지역이 포함된 제품명에서 제품명만을 추출하여 데이터간 일관성이 있도록 하거나,
투입 비율이 0으로 잘못 계산된 것을 다시 계산하는 등의 과정이 포함됩니다.
이렇게 일련의 과정을 거쳐 통합 정리된 데이터를 마리아 DB에 데이터 마트로 구축합니다.


12.
데이터마트는 다음과 같은 테이블로 구성되어 있습니다. 
일단 데이터마트가 만들어지면 APS 시스템은 매번 데이터를 가공할 필요 없이 즉시 처리할 수 있기 때문에 접근성이 향상됩니다. 

	
13. 
다음은 수요예측 과정입니다.
과거 판매량 정보만으로는 미래의 판매량을 바로 예측하기가 어렵습니다. 따라서 판매량과 관련된 변수들을 선정하고 이를 시계열 모델을 활용하여 미래 시점의 변수를 예측합니다. 그리고 이 미래 변수들을 사용해 머신러닝 모델로 미래의 판매량을 예측합니다.


14.
수요예측에서 사용한 변수에 대해 설명드리겠습니다. 
제품의 수요를 예측하기 위해서는 건설 업계의 보편적인 수요 패턴을 반영해야 합니다. 
건설업계에서는 날씨가 중요한 지표이기 때문에 날씨와 관련된 네 가지 변수를 선정하였습니다. 
시멘트는 온도, 습도에 따라 배합이 달라지는 특성을 가지고 있고, 콘크리트는 빗물과 섞이면 강도가 저하되는 문제가 발생하기 때문에
온도, 습도, 강수량, 신적설량, 총 네 가지 변수를 선정하고 기상청 API를 통해서 추출하였습니다. 


15. 
수요 예측에 사용될 다섯번째 변수는 건축착공면적입니다. 
건축착공면적은 건설경기 동행지표로서, 자재수급 동향 등을 예측해볼 수 있는 통계자료입니다. 
건축착공면적 수치를 보면 특정 기간 별로 차이가 있어 계절성이 드러나는 것을 확인할 수 있기 때문에 수요 예측을 위한 변수로 선정하였고 이는 통계청에서 운영하는 E-나라지표를 통해 추출하였습니다.


16.
이렇게 선택한 다섯가지 변수를 시계열 모델을 사용하여 수요예측할 기간만큼 증식합니다.
시계열 모델 중 오토 아리마 모델의 R스퀘어 값이 가장 높게 나와 증식에는 오토 아리마 모델을 사용하였습니다.

우측에서 오토아리마를 사용해 예측한 결과를 확인할 수 있습니다.  


17.
이러한 과정을 거쳐 증식된 변수 데이터를 활용하여 머신러닝으로 수요예측을 진행합니다.
LGBM Regressor 모델이 0.87로 r스퀘어 수치가 가장 높고, 오차 역시 대부분 낮은 값을 가집니다.
따라서, LGBM Regressor 모델을 사용하여 수요 예측을 진행하였습니다.


18.
다음은 생산계획 입니다.
생산계획이란 생산 개시에 앞서서 제품의 종류, 수량, 기간 등에 대한 계획을 세우는 것을 말합니다. 저희는 중장기 수요 예측 데이터의 앞 3개월을 활용하여 생산 계획을 수립하였습니다. 


19.
생산 계획에는 예측된 수주 정보가 담겨 있습니다. 예측 수주량과 데이터 마트에 저장된 원자재 정보를 활용하여 MES를 업데이트하고 이 시스템은 데이터 마트와 계속 연동되어 원자재 발주 및 관리를 자동화 합니다.


20.
S사는 원자재 발주부터 입고까지 6일, 제품 수주로부터 납기까지 3일, 총 9일의 평균 리드타임을 가지고 있습니다. 
따라서 원자재 발주는 매주 월요일마다 이뤄지며 원자재 발주가 들어가는 다음 주 월요일부터 일요일까지의 제품 생산에 필요한 총 원자재량을 계산하여 이에 맞춰 발주가 들어가게 됩니다.


21.
원자재를 발주할 때는, 리드타임 동안 발생할 수 있는 비상 수요에 대비하기 위해 안전재고량을 기준으로 발주를 진행합니다. 원자재는 항상 안전재고량 이상을 유지 해야 합니다. 따라서 사용하고 난 원자재가 안전재고량보다 밑으로 내려간 경우 안전재고량에서 부족한 만큼의 원자재량과 생산에 필요한 원자재량을 합쳐서 발주를 합니다. 반대의 경우는 안전재고 초과분에 맞춰 원자재 발주량을 줄입니다.


22.
위와 같은 과정을 거쳐 APS 시스템을 구축하면 다음과 같은 기대효과를 얻을 수 있습니다.
이전 시스템에서는 불가능했던 중장기 수요 예측이 가능하며 이를 통해 설비 투자 의사 결정과 효율적인 고객 관리가 가능합니다.
또한 정확도를 높인 생산계획과 이에 따른 재고 관리를 자동화하여 제품 생산 과정에서의 비용과, 매일 1시간 30분씩 소모되던 시간적 비용을 절감할 수 있습니다.


23.
다음은 태블로 대시보드를 통해 APS 시스템을 시각화한 것을 시연하도록 하겠습니다. 시각화를 통해 사용자는 APS시스템을 더욱 효율적으로 활용할 수 있습니다.


24.
대시보드는 수요 예측, 생산 관리 각각 두 페이지씩 총 4개의 페이지로 구성되어 있습니다. 
수요 예측 페이지는 추후 6개월 수요의 동향을 파악해볼 수 있는 부분으로 / 제품과 고객사별로 나누어 확인할 수 있습니다. 
우선 제품별 수요 예측 페이지부터 시연을 진행해보도록 하겠습니다. 
이 페이지는 앞으로 6개월 간의 제품의 수요량이 어떻게 될 지 월별로 확인해볼 수 있습니다. 
예측 기준일이 될 현재 일자는 4월 1일로 가정하고 있습니다. 
좌측 최상단에 위치한 수요 총 합계는 미래 6개월 동안 제품이 사용될 총 수요량을 보여줍니다. 
그리고 아래에 위치한 라인그래프를 통해 과거 2년 간의 제품의 수요 흐름이 어땠고, 예측일을 기준으로 앞으로 6개월 간의 수요가 어떻게 될지 전반적인 동향을 한 눈에 확인할 수 있습니다.  
좌측 하단에 위치한 세로 막대 그래프를 통해 월별로 제품의 구체적인 수요량을 확인할 수 있고 막대에 마우스를 올리면 우측 가로 막대 그래프를 통해 해당 월에 어떤 고객사에서 제품을 얼마만큼 수요할 것인지 내림차순으로 확인할 수 있습니다.  
현재는 제품 전체에 대한 값을 나타내고 있지만 총 수요 합계량 옆에 위치한 제품명 필터를 통해 제품별로도 앞써 말씀드린 값들을 확인해볼 수 있습니다. 
이 기업의 대표 상품인 pema hr 1000으로 보여드리겠습니다. 모든 값이 해당 제품으로 바뀐 것을 확인할 수 있습니다.  

고객사별 수요 예측 페이지를 보여드리겠습니다. 
앞서 제품별 수요 예측 페이지가 제품명 필터를 통해 진행되었던 반면 이 페이지에서는 거래처명 필터를 통해 해당 거래처가 어떤 제품을 얼마만큼 소비할 것인지 확인할 수 있습니다. 
고객사를 선택했을 때 해당 고객사가 6개월 간 소비할 제품의 총 합계를 살펴볼 수 있고, 월별로 어떤 제품을 얼마만큼 사용할 것인지 색 구분을 통해 확인할 수 있습니다.  
만약 이 고객사가 소비할 특정 제품을 선택해서 보고 싶은 경우에는 제품명 필터를 사용해 이 제품의 6개월 간 수요 합계와 월별 수요를 파악할 수 있습니다. 

다음은 생산관리 대시보드에 대해 말씀드리겠습니다. 
생산 관리 페이지는 제품별, 원자재별 페이지로 나누어져 있습니다. 
우선 제품별 생산관리 페이지부터 살펴보겠습니다. 
이 페이지는 추후 3개월 간 어떤 제품이 얼마만큼 소비되는지에 대해 초점이 맞추어져 있습니다. 
상단에 위치한 두 시트는 제품에 대한 월별, 일별 생산 계획을 담고 있고 하단에 위치한 두 시트는 일별로 생산할 제품에 필요한 원자재에 대한 정보를 담고 있습니다. 
제품 파트부터 살펴보자면, 왼쪽 시트는 월별로 총 생산하게 될 제품의 양을 확인할 수 있습니다. 
제품명 필터를 통해 월별로 생산될 제품의 총량을 확인할 수 있고 이 제품의 일별 생산 계획은 오른쪽에 위치한 캘린더 차트를 통해 확인할 수 있습니다. 
pema hr1000으로 시연해보겠습니다. 보시는 바와 같이 월별, 일별 생산 계획이 pema hr 1000에 관한 내용으로 변한 것을 알 수 있습니다. 
또한 이 제품명 필터를 사용할 시 / 아래에 위치한 제품별 원자재 필요량를 보여주는 시트도 변화하고 현재 일자인 4월 1일기준 pema hr1000 생산에 필요한 원자재별 필요량을 보여주는 것을 확인할 수 있습니다. 
그리고 이 원자재의 현재 재고가 어떤지 확인하고 싶을 때는 마우스를 원자재명에 위치시킴으로써 안전재고 대비 원자재 재고 현황을 알 수 있습니다. 
원자재 재고가 안전재고 기준선에 미치지 못할 경우 빨간색으로 변해 위험을 표시합니다. 

원자재별 생산관리 페이지에서는 앞으로 필요한 원자재량에 대해 파악할 수 있고, 원자재 발주를 확인하고 생산관리 담당자에게 메일을 전송할 수 있습니다. 
상단에 위치한 그래프를 통해 제품을 생산하기 위한 필요한 원자재량을 월별, 주별, 일별 단위로 확인할 수 있습니다. 
특정 원자재명을 클릭하면 막대 그래프를 통해 선택한 기간에 필요한 해당되는 원자재량을 확인할 수 있습니다. 
그리고 원자재별 필요한 총 수량을 알고 싶을 경우, 좌측 하단의 원자재명 필터를 통해 원자재를 선택하고 기간 필터를 통해 월별, 주별, 일별 필요한 수량을 확인할 수 있습니다. 
이 페이지 역시 오늘 날짜에 해당하는 안전재고 대비 원자재 재고량을 우측 하단에서 확인할 수 있습니다. 
원자재 재고량은 사용한 만큼 하루 하루 시간이 지나면서 감소되고 이렇게 감소된 재고량은 추후 발주를 통해 새롭게 원자재가 들어오면 더해지면서 자동으로 그 값이 업데이트 됩니다. 
다음 발주 일자인 4월 4일 발주를 하고 리드타임 일주일을 거쳐 재고가 입고된 뒤 11일 새롭게 갱신된 원자재 재고를 보여드리겠습니다. /////

앞서 안전재고 밑으로 떨어졌던 원자재들이 노란색으로 바뀌며 채워진 것을 확인할 수 있습니다. 
원자재 발주 시트에서는 다음 원자재 발주 계획을 확인하고 생산관리 담당자에게 이메일을 전송할 수 있습니다.
우클릭을 통해 데이터를 모두 선택하고 데이터 복사 기능을 통해 제품 생산 담당자에게 다음 원자재 발주 계획을 전송합니다. 

마지막으로 자동화 과정을 보여드리겠습니다. 
새롭게 들어온 값을 반영하여 최신 날짜로 업데이트하면 모든 데이터들도 함께 갱신됩니다.
5월 5일로 업데이트를 진행한 값을 보여드리겠습니다. 

실행 파일로 파이썬 코드를 작동시켜 자동으로 데이터 마트에 업데이트를 진행하였습니다. 
업데이트 시간은 약 5분 정도 소요되었습니다. 
업데이트된 일자에 맞춰 값들이 변화한 것을 확인할 수 있습니다.
여기까지 태블로 대시보드 시연을 마치겠습니다.


25.
위에서 했던 과정들을 바탕으로 사용설명서를 제작하였습니다.
사용설명서는 코드에 대해서 잘 모르시는 분들도 보다 쉽게 접근할 수 있도록 구성하였습니다.
사용설명서에는 소프트웨어에 대한 요약도, DataMart를 이용하는 방법, 그리고 
Tableau를 설치하는 방법과 대시보드의 이용방법을 소개하였습니다.


26.
이번 프로젝트에서 사용한 언어, 사용 환경 및 활용 라이브러리 입니다. 
Google Cloud Platform 에서 마리아db를 사용하여 데이터 마트를 생성하였으며, 파이썬과 sql을 사용하여 데이터를 가공하였습니다. 
APS 시스템 구현을 위해 콜랩과 주피터 노트북을 사용하였으며, PYMYSQL, SQL ALCHEMY, BEAUTIFULSOuP 등 다양한 파이썬 라이브러리또한 사용하였습니다.
이후 시각화 과정에서는 데이터 마트와 연동된 TABLEAU를 사용하여 대시보드를 구현하였습니다.


27.
끝으로 저희 팀원 소개와 소감입니다.


28. 
저희 조의 발표는 이상으로 마치겠습니다. 추가적으로 궁금한 점 있으신 분은 질문 해주시기 바랍니다.

감사합니다.